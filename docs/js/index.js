/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/index.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _trello_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./trello-util */ \"./src/trello-util.ts\");\n/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util */ \"./src/util.ts\");\n\n\nwindow.Promise = TrelloPowerUp.Promise;\nTrelloPowerUp.initialize({\n    // Button to open settings \n    'board-buttons': function (t) {\n        return [{\n                icon: {\n                    dark: `${window.location}img/stopwatch.svg`,\n                    light: `${window.location}img/stopwatch.svg`,\n                },\n                text: 'SLAs',\n                callback: () => t.modal({\n                    url: './settings.html',\n                    height: 360,\n                    fullscreen: false,\n                    title: 'SLAs for Trello'\n                }),\n                condition: 'edit'\n            }];\n    },\n    // Show running SLAs on front of card\n    'card-badges': function (t) {\n        return Object(_trello_util__WEBPACK_IMPORTED_MODULE_0__[\"getToken\"])(t).then(token => {\n            if (!token) {\n                return [];\n            }\n            return Object(_trello_util__WEBPACK_IMPORTED_MODULE_0__[\"getConfigurations\"])(t).then(configs => {\n                if (!configs) {\n                    return [];\n                }\n                return Object(_trello_util__WEBPACK_IMPORTED_MODULE_0__[\"getSlaData\"])(t).then((data) => {\n                    Object(_util__WEBPACK_IMPORTED_MODULE_1__[\"updateConfigs\"])(t, configs, data || {});\n                    return !data ? [] : Object(_util__WEBPACK_IMPORTED_MODULE_1__[\"getRunningSlas\"])(data, configs, false);\n                });\n            });\n        });\n    },\n    // Show running and completed SLAs on back of card\n    'card-detail-badges': function (t) {\n        return Object(_trello_util__WEBPACK_IMPORTED_MODULE_0__[\"getToken\"])(t).then(token => {\n            if (!token) {\n                return [];\n            }\n            return Object(_trello_util__WEBPACK_IMPORTED_MODULE_0__[\"getSlaData\"])(t).then((data) => {\n                if (!data) {\n                    return [];\n                }\n                return Object(_trello_util__WEBPACK_IMPORTED_MODULE_0__[\"getConfigurations\"])(t).then((configs) => {\n                    return !configs ? [] : Object(_util__WEBPACK_IMPORTED_MODULE_1__[\"getRunningSlas\"])(data, configs, true);\n                });\n            });\n        });\n    },\n    'authorization-status': function (t) {\n        return Object(_trello_util__WEBPACK_IMPORTED_MODULE_0__[\"getToken\"])(t)\n            .then(function (authToken) {\n            return { authorized: authToken != null };\n        });\n    },\n    'show-authorization': function (t) {\n        return t.popup({\n            title: 'SLAs for Trello',\n            url: './auth.html',\n            height: 100,\n        });\n    }\n}, {\n    appKey: '652d72f229f65b3457533bd55fdcf436',\n    appName: 'SLAs for Trello'\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaW5kZXgudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2luZGV4LnRzP2M2YWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0U2xhRGF0YSwgZ2V0Q29uZmlndXJhdGlvbnMsIGdldFRva2VuIH0gZnJvbSAnLi90cmVsbG8tdXRpbCc7XG5pbXBvcnQgeyBnZXRSdW5uaW5nU2xhcywgdXBkYXRlQ29uZmlncyB9IGZyb20gJy4vdXRpbCc7XG5cbmRlY2xhcmUgY29uc3QgVHJlbGxvUG93ZXJVcDogYW55O1xuXG53aW5kb3cuUHJvbWlzZSA9IFRyZWxsb1Bvd2VyVXAuUHJvbWlzZTtcblxuVHJlbGxvUG93ZXJVcC5pbml0aWFsaXplKHtcbiAgICAvLyBCdXR0b24gdG8gb3BlbiBzZXR0aW5ncyBcbiAgICAnYm9hcmQtYnV0dG9ucyc6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiBbe1xuICAgICAgICAgICAgaWNvbjoge1xuICAgICAgICAgICAgICAgIGRhcms6IGAke3dpbmRvdy5sb2NhdGlvbn1pbWcvc3RvcHdhdGNoLnN2Z2AsXG4gICAgICAgICAgICAgICAgbGlnaHQ6IGAke3dpbmRvdy5sb2NhdGlvbn1pbWcvc3RvcHdhdGNoLnN2Z2AsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGV4dDogJ1NMQXMnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpOiB2b2lkID0+IHQubW9kYWwoe1xuICAgICAgICAgICAgICAgIHVybDogJy4vc2V0dGluZ3MuaHRtbCcsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAzNjAsXG4gICAgICAgICAgICAgICAgZnVsbHNjcmVlbjogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdTTEFzIGZvciBUcmVsbG8nXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGNvbmRpdGlvbjogJ2VkaXQnXG4gICAgICAgIH1dO1xuICAgIH0sXG4gICAgLy8gU2hvdyBydW5uaW5nIFNMQXMgb24gZnJvbnQgb2YgY2FyZFxuICAgICdjYXJkLWJhZGdlcyc6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiBnZXRUb2tlbih0KS50aGVuKHRva2VuID0+IHtcbiAgICAgICAgICAgIGlmICghdG9rZW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICByZXR1cm4gZ2V0Q29uZmlndXJhdGlvbnModCkudGhlbihjb25maWdzID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWNvbmZpZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRTbGFEYXRhKHQpLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ29uZmlncyh0LCBjb25maWdzLCBkYXRhIHx8IHt9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFkYXRhID8gW10gOiBnZXRSdW5uaW5nU2xhcyhkYXRhLCBjb25maWdzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICAvLyBTaG93IHJ1bm5pbmcgYW5kIGNvbXBsZXRlZCBTTEFzIG9uIGJhY2sgb2YgY2FyZFxuICAgICdjYXJkLWRldGFpbC1iYWRnZXMnOiBmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gZ2V0VG9rZW4odCkudGhlbih0b2tlbiA9PiB7XG4gICAgICAgICAgICBpZiAoIXRva2VuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGdldFNsYURhdGEodCkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRDb25maWd1cmF0aW9ucyh0KS50aGVuKChjb25maWdzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhY29uZmlncyA/IFtdIDogZ2V0UnVubmluZ1NsYXMoZGF0YSwgY29uZmlncywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICAnYXV0aG9yaXphdGlvbi1zdGF0dXMnOiBmdW5jdGlvbih0KXtcbiAgICAgICAgcmV0dXJuIGdldFRva2VuKHQpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbihhdXRoVG9rZW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBhdXRob3JpemVkOiBhdXRoVG9rZW4gIT0gbnVsbCB9O1xuICAgICAgICAgICAgfSk7XG4gICAgfSxcbiAgICAnc2hvdy1hdXRob3JpemF0aW9uJzogZnVuY3Rpb24odCl7XG4gICAgICAgIHJldHVybiB0LnBvcHVwKHtcbiAgICAgICAgICAgIHRpdGxlOiAnU0xBcyBmb3IgVHJlbGxvJyxcbiAgICAgICAgICAgIHVybDogJy4vYXV0aC5odG1sJyxcbiAgICAgICAgICAgIGhlaWdodDogMTAwLFxuICAgICAgICB9KTtcbiAgICB9ICBcbn0sXG57XG4gICAgYXBwS2V5OiAnNjUyZDcyZjIyOWY2NWIzNDU3NTMzYmQ1NWZkY2Y0MzYnLFxuICAgIGFwcE5hbWU6ICdTTEFzIGZvciBUcmVsbG8nXG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUlBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/index.ts\n");

/***/ }),

/***/ "./src/trello-util.ts":
/*!****************************!*\
  !*** ./src/trello-util.ts ***!
  \****************************/
/*! exports provided: Condition, CardActionType, getConfigurations, setConfigurations, getSlaData, setSlaData, getToken, setToken, getCardActions, getLists */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Condition\", function() { return Condition; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CardActionType\", function() { return CardActionType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getConfigurations\", function() { return getConfigurations; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setConfigurations\", function() { return setConfigurations; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getSlaData\", function() { return getSlaData; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setSlaData\", function() { return setSlaData; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getToken\", function() { return getToken; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setToken\", function() { return setToken; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getCardActions\", function() { return getCardActions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getLists\", function() { return getLists; });\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nconst key = '652d72f229f65b3457533bd55fdcf436';\n// Right now we only provide being in a column as starting the SLA\nvar Condition;\n(function (Condition) {\n    Condition[\"ColumnName\"] = \"COLUMN_NAME\";\n})(Condition || (Condition = {}));\nvar CardActionType;\n(function (CardActionType) {\n    CardActionType[\"createCard\"] = \"createCard\";\n    CardActionType[\"updateCard\"] = \"updateCard\";\n})(CardActionType || (CardActionType = {}));\nconst getConfigurations = (t) => t.get('board', 'shared', 'config');\nconst setConfigurations = (t, config) => t.set('board', 'shared', 'config', config);\nconst getSlaData = (t) => t.get('card', 'shared', 'slaData');\nconst setSlaData = (t, slaData) => t.set('card', 'shared', 'slaData', slaData);\nconst getToken = (t) => t.get('member', 'private', 'authToken');\nconst setToken = (t, token) => t.set('member', 'private', 'authToken', token);\nconst getCardActions = (t) => __awaiter(void 0, void 0, void 0, function* () {\n    const { card: cardId } = t.getContext();\n    const token = yield getToken(t);\n    const url = `https://api.trello.com/1/cards/${cardId}/actions?filter=updateCard:idList,createCard&key=${key}&token=${token}`;\n    return axios.get(url).then(response => response.data).catch((e) => {\n        if (e && e.response && e.response.status && e.response.status === 401) {\n            setToken(t, undefined);\n        }\n    });\n});\nconst getLists = (t) => __awaiter(void 0, void 0, void 0, function* () {\n    const { board: boardId } = t.getContext();\n    const token = yield getToken(t);\n    const url = `https://api.trello.com/1/boards/${boardId}/lists?cards=none&filter=open&key=${key}&token=${token}`;\n    return axios.get(url).then(response => response.data).catch((e) => {\n        if (e && e.response && e.response.status && e.response.status === 401) {\n            setToken(t, undefined);\n        }\n    });\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdHJlbGxvLXV0aWwudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3RyZWxsby11dGlsLnRzP2JhYjciXSwic291cmNlc0NvbnRlbnQiOlsiZGVjbGFyZSBjb25zdCBheGlvczogYW55O1xuXG5jb25zdCBrZXkgPSAnNjUyZDcyZjIyOWY2NWIzNDU3NTMzYmQ1NWZkY2Y0MzYnO1xuXG4vLyBSaWdodCBub3cgd2Ugb25seSBwcm92aWRlIGJlaW5nIGluIGEgY29sdW1uIGFzIHN0YXJ0aW5nIHRoZSBTTEFcbmV4cG9ydCBlbnVtIENvbmRpdGlvbiB7XG4gICAgQ29sdW1uTmFtZSA9IFwiQ09MVU1OX05BTUVcIixcbn1cblxuZXhwb3J0IGVudW0gQ2FyZEFjdGlvblR5cGUgeyBcbiAgICBjcmVhdGVDYXJkID0gXCJjcmVhdGVDYXJkXCIsXG4gICAgdXBkYXRlQ2FyZCA9IFwidXBkYXRlQ2FyZFwiXG59XG5cbmV4cG9ydCB0eXBlIFNsYUNvbmRpdGlvbiA9IHtcbiAgICB0eXBlOiBDb25kaXRpb247XG4gICAgaWQ6IHN0cmluZztcbn1cblxuZXhwb3J0IHR5cGUgU2xhQ29uZmlndXJhdGlvbiA9IHtcbiAgICBpZDogc3RyaW5nO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBzdGFydENvbmRpdGlvbjogU2xhQ29uZGl0aW9uO1xuICAgIGVuZENvbmRpdGlvbjogU2xhQ29uZGl0aW9uO1xuICAgIHRpbWU6IG51bWJlcjsgLy8gTWludXRlc1xufVxuXG5leHBvcnQgdHlwZSBTbGFEYXRhID0ge1xuICAgIHN0YXJ0VGltZT86IG51bWJlcjsgLy8gVW5peCB0aW1lc3RhbXAgbWlsbGlzZWNvbmRzLiBPbmx5IGV4aXN0cyBpZiBTTEEgaGFzIHN0YXJ0ZWRcbiAgICBlbmRUaW1lPzogbnVtYmVyOyAvLyBVbml4IHRpbWVzdGFtcCBpbiBtaWxsaXNlY29uZHMuIE9ubHkgZXhpc3RzIGlmIFNMQSBoYXMgZW5kZWRcbn1cblxuZXhwb3J0IHR5cGUgU2xhRGF0YU1hcCA9IHtcbiAgICBbaWQ6IG51bWJlcl06IFNsYURhdGE7XG59XG5cbmV4cG9ydCB0eXBlIENhcmRBY3Rpb24gPSBDcmVhdGVDYXJkQWN0aW9uIHwgVXBkYXRlQ2FyZEFjdGlvbjtcblxuZXhwb3J0IHR5cGUgVXBkYXRlQ2FyZEFjdGlvbiA9IHtcbiAgICBkYXRhOiB7XG4gICAgICAgIGxpc3RBZnRlcjoge2lkOiBzdHJpbmd9O1xuICAgICAgICBsaXN0QmVmb3JlOiB7aWQ6IHN0cmluZ307XG4gICAgfTtcbiAgICB0eXBlOiB0eXBlb2YgQ2FyZEFjdGlvblR5cGUudXBkYXRlQ2FyZDtcbiAgICBkYXRlOiBzdHJpbmc7IC8vIGZvcm1hdCAyMDE5LTExLTI5VDIxOjA1OjI4LjUxMFpcbn1cblxuZXhwb3J0IHR5cGUgQ3JlYXRlQ2FyZEFjdGlvbiA9IHtcbiAgICBkYXRhOiB7XG4gICAgICAgIGxpc3Q6IHtpZDogc3RyaW5nfTtcbiAgICB9O1xuICAgIHR5cGU6IHR5cGVvZiBDYXJkQWN0aW9uVHlwZS5jcmVhdGVDYXJkO1xuICAgIGRhdGU6IHN0cmluZzsgLy8gZm9ybWF0IDIwMTktMTEtMjlUMjE6MDU6MjguNTEwWlxufVxuXG5leHBvcnQgdHlwZSBMaXN0ID0ge1xuICAgIGlkOiBzdHJpbmcsXG4gICAgbmFtZTogc3RyaW5nLFxufVxuXG5leHBvcnQgY29uc3QgZ2V0Q29uZmlndXJhdGlvbnMgPSAodCk6IFByb21pc2U8U2xhQ29uZmlndXJhdGlvbltdIHwgdm9pZD4gPT4gdC5nZXQoJ2JvYXJkJywgJ3NoYXJlZCcsICdjb25maWcnKTtcbmV4cG9ydCBjb25zdCBzZXRDb25maWd1cmF0aW9ucyA9ICh0LCBjb25maWc6IFNsYUNvbmZpZ3VyYXRpb25bXSk6IHZvaWQgPT4gdC5zZXQoJ2JvYXJkJywgJ3NoYXJlZCcsICdjb25maWcnLCBjb25maWcpO1xuZXhwb3J0IGNvbnN0IGdldFNsYURhdGEgPSAodCk6IFByb21pc2U8U2xhRGF0YU1hcCB8IHZvaWQ+ID0+IHQuZ2V0KCdjYXJkJywgJ3NoYXJlZCcsICdzbGFEYXRhJyk7XG5leHBvcnQgY29uc3Qgc2V0U2xhRGF0YSA9ICh0LCBzbGFEYXRhOiBTbGFEYXRhTWFwKTogdm9pZCA9PiB0LnNldCgnY2FyZCcsICdzaGFyZWQnLCAnc2xhRGF0YScsIHNsYURhdGEpO1xuZXhwb3J0IGNvbnN0IGdldFRva2VuID0gKHQpOiBQcm9taXNlPHN0cmluZyB8IHZvaWQ+ID0+IHQuZ2V0KCdtZW1iZXInLCAncHJpdmF0ZScsICdhdXRoVG9rZW4nKTtcbmV4cG9ydCBjb25zdCBzZXRUb2tlbiA9ICh0LCB0b2tlbik6IFByb21pc2U8dm9pZD4gPT4gdC5zZXQoJ21lbWJlcicsICdwcml2YXRlJywgJ2F1dGhUb2tlbicsIHRva2VuKTtcblxuZXhwb3J0IGNvbnN0IGdldENhcmRBY3Rpb25zID0gYXN5bmMgKHQpOiBQcm9taXNlPENhcmRBY3Rpb25bXT4gPT4ge1xuICAgIGNvbnN0IHsgY2FyZDogY2FyZElkIH0gPSB0LmdldENvbnRleHQoKTtcbiAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGdldFRva2VuKHQpO1xuICAgIGNvbnN0IHVybCA9IGBodHRwczovL2FwaS50cmVsbG8uY29tLzEvY2FyZHMvJHtjYXJkSWR9L2FjdGlvbnM/ZmlsdGVyPXVwZGF0ZUNhcmQ6aWRMaXN0LGNyZWF0ZUNhcmQma2V5PSR7a2V5fSZ0b2tlbj0ke3Rva2VufWA7XG4gICAgcmV0dXJuIGF4aW9zLmdldCh1cmwpLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuZGF0YSkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgaWYgKGUgJiYgZS5yZXNwb25zZSAmJiBlLnJlc3BvbnNlLnN0YXR1cyAmJiBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICBzZXRUb2tlbih0LCB1bmRlZmluZWQpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0TGlzdHMgPSBhc3luYyAodCk6IFByb21pc2U8TGlzdFtdPiA9PiB7XG4gICAgY29uc3QgeyBib2FyZDogYm9hcmRJZCB9ID0gdC5nZXRDb250ZXh0KCk7XG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBnZXRUb2tlbih0KTtcbiAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly9hcGkudHJlbGxvLmNvbS8xL2JvYXJkcy8ke2JvYXJkSWR9L2xpc3RzP2NhcmRzPW5vbmUmZmlsdGVyPW9wZW4ma2V5PSR7a2V5fSZ0b2tlbj0ke3Rva2VufWA7XG4gICAgcmV0dXJuIGF4aW9zLmdldCh1cmwpLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuZGF0YSkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgaWYgKGUgJiYgZS5yZXNwb25zZSAmJiBlLnJlc3BvbnNlLnN0YXR1cyAmJiBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICBzZXRUb2tlbih0LCB1bmRlZmluZWQpO1xuICAgICAgICB9XG4gICAgfSk7XG59Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFnREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/trello-util.ts\n");

/***/ }),

/***/ "./src/util.ts":
/*!*********************!*\
  !*** ./src/util.ts ***!
  \*********************/
/*! exports provided: truncate, getHumanReadableTime, getMinutesRemaining, getColor, getRunningSlas, getEndTime, getStartTime, getUpdatedSlaData, updateConfigs, generateUuid */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"truncate\", function() { return truncate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getHumanReadableTime\", function() { return getHumanReadableTime; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getMinutesRemaining\", function() { return getMinutesRemaining; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getColor\", function() { return getColor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getRunningSlas\", function() { return getRunningSlas; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getEndTime\", function() { return getEndTime; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getStartTime\", function() { return getStartTime; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getUpdatedSlaData\", function() { return getUpdatedSlaData; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateConfigs\", function() { return updateConfigs; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"generateUuid\", function() { return generateUuid; });\n/* harmony import */ var _trello_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./trello-util */ \"./src/trello-util.ts\");\n\nconst truncate = (str, n, shouldEllipse) => (str.length > n) ? str.substr(0, n - 1) + `${shouldEllipse ? '&hellip;' : ''}` : str;\nconst getHumanReadableTime = (realMinutes) => {\n    const isNegative = realMinutes < 0;\n    const minutes = isNegative ? realMinutes * -1 : realMinutes;\n    const negativeSign = isNegative ? '-' : '';\n    const MINUTES = 'min';\n    const HOURS = 'h';\n    const DAYS = 'd';\n    if (minutes < 60) {\n        return `${negativeSign}${minutes}${MINUTES}`;\n    }\n    if (minutes < 1440) {\n        const hours = Math.floor(minutes / 60);\n        const hoursString = hours > 0 ? `${hours}${HOURS}` : '';\n        const remainingMinutes = minutes - 60 * hours;\n        const minutesString = remainingMinutes > 0 ? `${remainingMinutes}${MINUTES}` : '';\n        const spacer = hoursString && minutesString ? ' ' : '';\n        return `${negativeSign}${hoursString}${spacer}${minutesString}`;\n    }\n    const days = Math.floor(minutes / 1440);\n    const daysString = days > 0 ? `${days}${DAYS}` : '';\n    const remainingMinutes = minutes - days * 1440;\n    const remainingHours = Math.floor(remainingMinutes / 60);\n    const hoursString = remainingHours > 0 ? `${remainingHours}${HOURS}` : '';\n    const spacer = daysString && hoursString ? ' ' : '';\n    return `${negativeSign}${daysString}${spacer}${hoursString}`;\n};\nconst getMinutesRemaining = (startTime, endTime, config) => {\n    const minutesElapsed = Math.floor((endTime - startTime) / 1000 / 60);\n    const minutesRemaining = config.time - minutesElapsed;\n    return minutesRemaining;\n};\nconst getColor = (minutesRemaining, isComplete) => {\n    if (isComplete) {\n        return 'grey';\n    }\n    ;\n    if (minutesRemaining < 0) {\n        return 'red';\n    }\n    else if (minutesRemaining < 60) {\n        return 'yellow';\n    }\n    return 'green';\n};\nconst getRunningSlas = (data, configs, detailed) => {\n    const runningSlas = [];\n    const completeSlas = [];\n    configs.forEach((config) => {\n        if (data[config.id]) {\n            const { startTime, endTime } = data[config.id];\n            if (startTime && !endTime) {\n                runningSlas.push({\n                    dynamic: function () {\n                        const unix = moment().valueOf();\n                        const minutesRemaining = getMinutesRemaining(startTime, unix, config);\n                        const humanReadable = getHumanReadableTime(minutesRemaining);\n                        return Object.assign(Object.assign(Object.assign({ text: humanReadable, color: getColor(minutesRemaining, false) }, (detailed ? { title: `${config.name} - Ongoing` } : {})), (!detailed ? { icon: `${window.location}img/stopwatch.svg` } : {})), { refresh: 60 });\n                    }\n                });\n            }\n            if (startTime && endTime && detailed) {\n                const minutesRemaining = getMinutesRemaining(startTime, endTime, config);\n                const humanReadable = getHumanReadableTime(minutesRemaining);\n                completeSlas.push({\n                    text: humanReadable,\n                    color: getColor(minutesRemaining, true),\n                    title: `${config.name} - stopped`,\n                });\n            }\n        }\n    });\n    // We want the complete SLAs to come after the running ones\n    const allSlas = runningSlas.concat(completeSlas);\n    return allSlas;\n};\nconst getEndTime = (actions, endCondition, startTime) => {\n    let endTime = undefined;\n    actions.forEach((action) => {\n        if (action.type === _trello_util__WEBPACK_IMPORTED_MODULE_0__[\"CardActionType\"].updateCard) {\n            if (action.data.listAfter.id === endCondition.id &&\n                (!endTime || moment(action.date).valueOf() < endTime) &&\n                moment(action.date).valueOf() > startTime) {\n                endTime = moment(action.date).valueOf();\n            }\n        }\n    });\n    return endTime;\n};\nconst getStartTime = (actions, startCondition) => {\n    let startTime = undefined;\n    actions.forEach((action) => {\n        if (action.type === _trello_util__WEBPACK_IMPORTED_MODULE_0__[\"CardActionType\"].createCard && action.data.list.id === startCondition.id) {\n            startTime = moment(action.date).valueOf();\n        }\n        else if (action.type === _trello_util__WEBPACK_IMPORTED_MODULE_0__[\"CardActionType\"].updateCard &&\n            action.data.listAfter.id === startCondition.id &&\n            !startTime || (moment(action.date).valueOf() < startTime)) {\n            startTime = moment(action.date).valueOf();\n        }\n    });\n    return startTime;\n};\nconst getUpdatedSlaData = (actions, configs, slaMap) => {\n    const updatedSlaMap = slaMap;\n    let hasChanged = false;\n    configs.forEach(config => {\n        const { id, startCondition, endCondition } = config;\n        if (!updatedSlaMap[id]) {\n            updatedSlaMap[id] = {};\n        }\n        const { startTime = undefined, endTime = undefined } = updatedSlaMap[id];\n        // We always recalculate start times and end times, in case the config has been edited.\n        const newStartTime = getStartTime(actions, startCondition);\n        const startTimeHasChanged = newStartTime !== startTime;\n        const newEndTime = startTime || newStartTime ? getEndTime(actions, endCondition, startTime || newStartTime) : undefined;\n        const endTimeHasChanged = newEndTime !== endTime;\n        if (startTimeHasChanged) {\n            hasChanged = true;\n            updatedSlaMap[id].startTime = newStartTime;\n        }\n        if (endTimeHasChanged) {\n            hasChanged = true;\n            updatedSlaMap[id].endTime = newEndTime;\n        }\n    });\n    return hasChanged ? updatedSlaMap : undefined;\n};\n// Find and remove any data from configs that have been since-deleted\nconst getSlaDataWithRemovals = (configs, slaMap) => {\n    const keys = Object.keys(slaMap);\n    if (keys.length === 0) {\n        return undefined;\n    }\n    const configIds = configs.map(config => config.id);\n    let removed = undefined;\n    keys.forEach(key => {\n        if (configIds.indexOf(key) === -1) {\n            removed = true;\n            delete slaMap[key];\n        }\n    });\n    return removed ? slaMap : undefined;\n};\nconst updateConfigs = (t, configs, slaMap) => {\n    Object(_trello_util__WEBPACK_IMPORTED_MODULE_0__[\"getCardActions\"])(t).then((actions) => {\n        const updatedSlaData = getUpdatedSlaData(actions, configs, slaMap);\n        if (updatedSlaData) {\n            const slaDataWithRemovals = getSlaDataWithRemovals(configs, updatedSlaData);\n            const result = slaDataWithRemovals ? slaDataWithRemovals : updatedSlaData;\n            Object(_trello_util__WEBPACK_IMPORTED_MODULE_0__[\"setSlaData\"])(t, result);\n        }\n        else {\n            const slaDataWithRemovals = getSlaDataWithRemovals(configs, slaMap);\n            if (slaDataWithRemovals) {\n                Object(_trello_util__WEBPACK_IMPORTED_MODULE_0__[\"setSlaData\"])(t, slaDataWithRemovals);\n            }\n        }\n    });\n};\n// https://gist.github.com/jed/982883\nconst generateUuid = function () { return (\"\" + 1e7 + -1e3 + -4e3 + -8e3 + -1e11).replace(/1|0/g, function () { return (0 | Math.random() * 16).toString(16); }); };\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvdXRpbC50cz80OTU2Il0sInNvdXJjZXNDb250ZW50IjpbImRlY2xhcmUgY29uc3QgbW9tZW50OiBhbnk7XG5cbmltcG9ydCB7IHNldFNsYURhdGEsIFNsYURhdGFNYXAsIFNsYUNvbmZpZ3VyYXRpb24sIGdldENhcmRBY3Rpb25zLCBDYXJkQWN0aW9uLCBDYXJkQWN0aW9uVHlwZSwgU2xhQ29uZGl0aW9uIH0gZnJvbSAnLi90cmVsbG8tdXRpbCc7XG5cbnR5cGUgQ2FyZEJhZGdlID0ge1xuICB0ZXh0OiBzdHJpbmc7XG4gIGNvbG9yOiBzdHJpbmc7XG4gIHJlZnJlc2g6IG51bWJlcjtcbiAgaWNvbj86IHN0cmluZztcbiAgdGl0bGU/OiBzdHJpbmc7XG59O1xuXG50eXBlIENhcmREZXRhaWxlZEJhZGdlID0ge1xuICB0aXRsZTogc3RyaW5nO1xuICBjb2xvcjogc3RyaW5nO1xuICB0ZXh0OiBzdHJpbmc7XG4gIGNhbGxiYWNrPzogKCkgPT4ge307XG59O1xuXG5leHBvcnQgY29uc3QgdHJ1bmNhdGUgPSAoc3RyOiBzdHJpbmcsIG46IG51bWJlciwgc2hvdWxkRWxsaXBzZTogYm9vbGVhbik6IHN0cmluZyA9PlxuICAgIChzdHIubGVuZ3RoID4gbikgPyBzdHIuc3Vic3RyKDAsIG4tMSkgKyBgJHtzaG91bGRFbGxpcHNlID8gJyZoZWxsaXA7JyA6ICcnfWAgOiBzdHI7XG5cbmV4cG9ydCBjb25zdCBnZXRIdW1hblJlYWRhYmxlVGltZSA9IChyZWFsTWludXRlczogbnVtYmVyKTogc3RyaW5nID0+IHtcbiAgICBjb25zdCBpc05lZ2F0aXZlID0gcmVhbE1pbnV0ZXMgPCAwO1xuICAgIGNvbnN0IG1pbnV0ZXMgPSBpc05lZ2F0aXZlID8gcmVhbE1pbnV0ZXMgKiAtMSA6IHJlYWxNaW51dGVzO1xuICAgIGNvbnN0IG5lZ2F0aXZlU2lnbiA9IGlzTmVnYXRpdmUgPyAnLScgOiAnJztcblxuICAgIGNvbnN0IE1JTlVURVMgPSAnbWluJztcbiAgICBjb25zdCBIT1VSUyA9ICdoJztcbiAgICBjb25zdCBEQVlTID0gJ2QnO1xuXG4gICAgaWYgKG1pbnV0ZXMgPCA2MCkge1xuICAgICAgICByZXR1cm4gYCR7bmVnYXRpdmVTaWdufSR7bWludXRlc30ke01JTlVURVN9YDtcbiAgICB9IGlmIChtaW51dGVzIDwgMTQ0MCkge1xuICAgICAgICBjb25zdCBob3VycyA9IE1hdGguZmxvb3IobWludXRlcyAvIDYwKTtcbiAgICAgICAgY29uc3QgaG91cnNTdHJpbmcgPSBob3VycyA+IDAgPyBgJHtob3Vyc30ke0hPVVJTfWAgOiAnJztcbiAgICAgICAgY29uc3QgcmVtYWluaW5nTWludXRlcyA9IG1pbnV0ZXMgLSA2MCAqIGhvdXJzO1xuICAgICAgICBjb25zdCBtaW51dGVzU3RyaW5nID0gcmVtYWluaW5nTWludXRlcyA+IDAgPyBgJHtyZW1haW5pbmdNaW51dGVzfSR7TUlOVVRFU31gIDogJyc7XG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGhvdXJzU3RyaW5nICYmIG1pbnV0ZXNTdHJpbmcgPyAnICcgOiAnJztcbiAgICAgICAgcmV0dXJuIGAke25lZ2F0aXZlU2lnbn0ke2hvdXJzU3RyaW5nfSR7c3BhY2VyfSR7bWludXRlc1N0cmluZ31gO1xuICAgIH0gXG4gICAgY29uc3QgZGF5cyA9IE1hdGguZmxvb3IobWludXRlcyAvIDE0NDApO1xuICAgIGNvbnN0IGRheXNTdHJpbmcgPSBkYXlzID4gMCA/IGAke2RheXN9JHtEQVlTfWAgOiAnJztcbiAgICBjb25zdCByZW1haW5pbmdNaW51dGVzID0gbWludXRlcyAtIGRheXMgKiAxNDQwO1xuICAgIGNvbnN0IHJlbWFpbmluZ0hvdXJzID0gTWF0aC5mbG9vcihyZW1haW5pbmdNaW51dGVzIC8gNjApOyBcbiAgICBjb25zdCBob3Vyc1N0cmluZyA9IHJlbWFpbmluZ0hvdXJzID4gMCA/IGAke3JlbWFpbmluZ0hvdXJzfSR7SE9VUlN9YCA6ICcnO1xuICAgIGNvbnN0IHNwYWNlciA9IGRheXNTdHJpbmcgJiYgaG91cnNTdHJpbmcgPyAnICcgOiAnJztcbiAgICByZXR1cm4gYCR7bmVnYXRpdmVTaWdufSR7ZGF5c1N0cmluZ30ke3NwYWNlcn0ke2hvdXJzU3RyaW5nfWA7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0TWludXRlc1JlbWFpbmluZyA9IChzdGFydFRpbWU6IG51bWJlciwgZW5kVGltZTogbnVtYmVyLCBjb25maWc6IFNsYUNvbmZpZ3VyYXRpb24pOiBudW1iZXIgPT4ge1xuICAgIGNvbnN0IG1pbnV0ZXNFbGFwc2VkID0gTWF0aC5mbG9vcigoZW5kVGltZSAtIHN0YXJ0VGltZSkgLyAxMDAwIC8gNjApO1xuICAgIGNvbnN0IG1pbnV0ZXNSZW1haW5pbmcgPSBjb25maWcudGltZSAtIG1pbnV0ZXNFbGFwc2VkO1xuICAgIHJldHVybiBtaW51dGVzUmVtYWluaW5nO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldENvbG9yID0gKG1pbnV0ZXNSZW1haW5pbmc6IG51bWJlciwgaXNDb21wbGV0ZTogYm9vbGVhbik6IHN0cmluZyA9PiB7XG4gICAgaWYgKGlzQ29tcGxldGUpIHtcbiAgICAgICAgcmV0dXJuICdncmV5JztcbiAgICB9O1xuXG4gICAgaWYgKG1pbnV0ZXNSZW1haW5pbmcgPCAwKSB7XG4gICAgICAgIHJldHVybiAncmVkJztcbiAgICB9IGVsc2UgaWYgKG1pbnV0ZXNSZW1haW5pbmcgPCA2MCkge1xuICAgICAgICByZXR1cm4gJ3llbGxvdyc7XG4gICAgfVxuICAgIHJldHVybiAnZ3JlZW4nO1xufTtcblxudHlwZSBEeW5hbWljQmFkZ2UgPSB7XG4gIGR5bmFtaWM6ICgpID0+IENhcmRCYWRnZTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRSdW5uaW5nU2xhcyA9IChkYXRhOiBTbGFEYXRhTWFwLCBjb25maWdzOiBTbGFDb25maWd1cmF0aW9uW10sIGRldGFpbGVkOiBib29sZWFuKTogQ2FyZEJhZGdlW10gfCBDYXJkRGV0YWlsZWRCYWRnZVtdIHwgRHluYW1pY0JhZGdlW10gPT4ge1xuICAgIGNvbnN0IHJ1bm5pbmdTbGFzID0gW107XG4gICAgY29uc3QgY29tcGxldGVTbGFzID0gW107XG4gIFxuICAgIGNvbmZpZ3MuZm9yRWFjaCgoY29uZmlnKSA9PiB7XG4gICAgICAgIGlmIChkYXRhW2NvbmZpZy5pZF0pIHtcbiAgICAgICAgICAgIGNvbnN0IHsgc3RhcnRUaW1lLCBlbmRUaW1lIH0gPSBkYXRhW2NvbmZpZy5pZF07XG4gICAgICAgICAgICBpZiAoc3RhcnRUaW1lICYmICFlbmRUaW1lKSB7XG4gICAgICAgICAgICAgICAgcnVubmluZ1NsYXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGR5bmFtaWM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdW5peCA9IG1vbWVudCgpLnZhbHVlT2YoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbnV0ZXNSZW1haW5pbmcgPSBnZXRNaW51dGVzUmVtYWluaW5nKHN0YXJ0VGltZSwgdW5peCwgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGh1bWFuUmVhZGFibGUgPSBnZXRIdW1hblJlYWRhYmxlVGltZShtaW51dGVzUmVtYWluaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogaHVtYW5SZWFkYWJsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogZ2V0Q29sb3IobWludXRlc1JlbWFpbmluZywgZmFsc2UpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLihkZXRhaWxlZCA/IHsgdGl0bGU6IGAke2NvbmZpZy5uYW1lfSAtIE9uZ29pbmdgIH0gOiB7fSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uKCFkZXRhaWxlZCA/IHtpY29uOiBgJHt3aW5kb3cubG9jYXRpb259aW1nL3N0b3B3YXRjaC5zdmdgfSA6IHt9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoOiA2MCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN0YXJ0VGltZSAmJiBlbmRUaW1lICYmIGRldGFpbGVkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWludXRlc1JlbWFpbmluZyA9IGdldE1pbnV0ZXNSZW1haW5pbmcoc3RhcnRUaW1lLCBlbmRUaW1lLCBjb25maWcpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGh1bWFuUmVhZGFibGUgPSBnZXRIdW1hblJlYWRhYmxlVGltZShtaW51dGVzUmVtYWluaW5nKTtcbiAgICAgICAgICAgICAgICBjb21wbGV0ZVNsYXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGh1bWFuUmVhZGFibGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBnZXRDb2xvcihtaW51dGVzUmVtYWluaW5nLCB0cnVlKSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke2NvbmZpZy5uYW1lfSAtIHN0b3BwZWRgLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdlIHdhbnQgdGhlIGNvbXBsZXRlIFNMQXMgdG8gY29tZSBhZnRlciB0aGUgcnVubmluZyBvbmVzXG4gICAgY29uc3QgYWxsU2xhcyA9IHJ1bm5pbmdTbGFzLmNvbmNhdChjb21wbGV0ZVNsYXMpO1xuICAgIFxuICAgIHJldHVybiBhbGxTbGFzO1xufTtcblxuXG5cbmV4cG9ydCBjb25zdCBnZXRFbmRUaW1lID0gKGFjdGlvbnM6IENhcmRBY3Rpb25bXSwgZW5kQ29uZGl0aW9uOiBTbGFDb25kaXRpb24sIHN0YXJ0VGltZTogbnVtYmVyKTogbnVtYmVyIHwgdm9pZCA9PiB7XG4gICAgbGV0IGVuZFRpbWU6IG51bWJlciB8IHZvaWQgPSB1bmRlZmluZWQ7XG4gICAgYWN0aW9ucy5mb3JFYWNoKChhY3Rpb24pID0+IHtcbiAgICAgICAgaWYgKGFjdGlvbi50eXBlID09PSBDYXJkQWN0aW9uVHlwZS51cGRhdGVDYXJkKSB7XG4gICAgICAgICAgICBpZiAoYWN0aW9uLmRhdGEubGlzdEFmdGVyLmlkID09PSBlbmRDb25kaXRpb24uaWQgJiZcbiAgICAgICAgKCFlbmRUaW1lIHx8IG1vbWVudChhY3Rpb24uZGF0ZSkudmFsdWVPZigpIDwgZW5kVGltZSkgICYmIFxuICAgICAgICBtb21lbnQoYWN0aW9uLmRhdGUpLnZhbHVlT2YoKSA+IHN0YXJ0VGltZSkge1xuICAgICAgICAgICAgICAgIGVuZFRpbWUgPSBtb21lbnQoYWN0aW9uLmRhdGUpLnZhbHVlT2YoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGVuZFRpbWU7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0U3RhcnRUaW1lID0gKGFjdGlvbnM6IENhcmRBY3Rpb25bXSwgc3RhcnRDb25kaXRpb246IFNsYUNvbmRpdGlvbik6IG51bWJlciB8IHZvaWQgPT4ge1xuICAgIGxldCBzdGFydFRpbWU6IG51bWJlciB8IHZvaWQgPSB1bmRlZmluZWQ7XG5cbiAgICBhY3Rpb25zLmZvckVhY2goKGFjdGlvbikgPT4ge1xuICAgICAgICBpZiAoYWN0aW9uLnR5cGUgPT09IENhcmRBY3Rpb25UeXBlLmNyZWF0ZUNhcmQgJiYgYWN0aW9uLmRhdGEubGlzdC5pZCA9PT0gc3RhcnRDb25kaXRpb24uaWQpIHtcbiAgICAgICAgICAgIHN0YXJ0VGltZSA9IG1vbWVudChhY3Rpb24uZGF0ZSkudmFsdWVPZigpO1xuICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi50eXBlID09PSBDYXJkQWN0aW9uVHlwZS51cGRhdGVDYXJkICYmXG4gICAgICBhY3Rpb24uZGF0YS5saXN0QWZ0ZXIuaWQgPT09IHN0YXJ0Q29uZGl0aW9uLmlkICYmXG4gICAgICAhc3RhcnRUaW1lIHx8IChtb21lbnQoYWN0aW9uLmRhdGUpLnZhbHVlT2YoKSA8IHN0YXJ0VGltZSkpIHtcbiAgICAgICAgICAgIHN0YXJ0VGltZSA9IG1vbWVudChhY3Rpb24uZGF0ZSkudmFsdWVPZigpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3RhcnRUaW1lO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldFVwZGF0ZWRTbGFEYXRhID0gKGFjdGlvbnM6IENhcmRBY3Rpb25bXSwgY29uZmlnczogU2xhQ29uZmlndXJhdGlvbltdLCBzbGFNYXA6IFNsYURhdGFNYXApOiBTbGFEYXRhTWFwIHwgdm9pZCA9PiB7XG4gICAgY29uc3QgdXBkYXRlZFNsYU1hcCA9IHNsYU1hcDtcbiAgICBsZXQgaGFzQ2hhbmdlZCA9IGZhbHNlO1xuXG4gICAgY29uZmlncy5mb3JFYWNoKGNvbmZpZyA9PiB7XG4gICAgICAgIGNvbnN0IHsgaWQsIHN0YXJ0Q29uZGl0aW9uLCBlbmRDb25kaXRpb24gfSA9IGNvbmZpZztcblxuICAgICAgICBpZiAoIXVwZGF0ZWRTbGFNYXBbaWRdKSB7XG4gICAgICAgICAgICB1cGRhdGVkU2xhTWFwW2lkXSA9IHt9O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeyBzdGFydFRpbWUgPSB1bmRlZmluZWQsIGVuZFRpbWUgPSB1bmRlZmluZWQgfSA9IHVwZGF0ZWRTbGFNYXBbaWRdO1xuXG4gICAgICAgIC8vIFdlIGFsd2F5cyByZWNhbGN1bGF0ZSBzdGFydCB0aW1lcyBhbmQgZW5kIHRpbWVzLCBpbiBjYXNlIHRoZSBjb25maWcgaGFzIGJlZW4gZWRpdGVkLlxuICAgICAgICBjb25zdCBuZXdTdGFydFRpbWUgPSBnZXRTdGFydFRpbWUoYWN0aW9ucywgc3RhcnRDb25kaXRpb24pO1xuICAgICAgICBjb25zdCBzdGFydFRpbWVIYXNDaGFuZ2VkOiBib29sZWFuID0gbmV3U3RhcnRUaW1lICE9PSBzdGFydFRpbWU7XG4gICAgICAgIGNvbnN0IG5ld0VuZFRpbWUgPSBzdGFydFRpbWUgfHwgbmV3U3RhcnRUaW1lID8gZ2V0RW5kVGltZShhY3Rpb25zLCBlbmRDb25kaXRpb24sIHN0YXJ0VGltZSB8fCBuZXdTdGFydFRpbWUpIDogdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCBlbmRUaW1lSGFzQ2hhbmdlZDogYm9vbGVhbiA9IG5ld0VuZFRpbWUgIT09IGVuZFRpbWU7XG4gICAgXG4gICAgICAgIGlmIChzdGFydFRpbWVIYXNDaGFuZ2VkKSB7XG4gICAgICAgICAgICBoYXNDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIHVwZGF0ZWRTbGFNYXBbaWRdLnN0YXJ0VGltZSA9IG5ld1N0YXJ0VGltZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbmRUaW1lSGFzQ2hhbmdlZCkge1xuICAgICAgICAgICAgaGFzQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICB1cGRhdGVkU2xhTWFwW2lkXS5lbmRUaW1lID0gbmV3RW5kVGltZTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGhhc0NoYW5nZWQgPyB1cGRhdGVkU2xhTWFwIDogdW5kZWZpbmVkO1xufTtcblxuLy8gRmluZCBhbmQgcmVtb3ZlIGFueSBkYXRhIGZyb20gY29uZmlncyB0aGF0IGhhdmUgYmVlbiBzaW5jZS1kZWxldGVkXG5jb25zdCBnZXRTbGFEYXRhV2l0aFJlbW92YWxzID0gKGNvbmZpZ3M6IFNsYUNvbmZpZ3VyYXRpb25bXSwgc2xhTWFwOiBTbGFEYXRhTWFwKTogU2xhRGF0YU1hcCB8IHZvaWQgPT4ge1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhzbGFNYXApO1xuICAgIGlmIChrZXlzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBjb25zdCBjb25maWdJZHMgPSBjb25maWdzLm1hcChjb25maWcgPT4gY29uZmlnLmlkKTtcblxuICAgIGxldCByZW1vdmVkID0gdW5kZWZpbmVkO1xuICAgIGtleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBpZiAoY29uZmlnSWRzLmluZGV4T2Yoa2V5KSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJlbW92ZWQgPSB0cnVlO1xuICAgICAgICAgICAgZGVsZXRlIHNsYU1hcFtrZXldO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVtb3ZlZCA/IHNsYU1hcCA6IHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBjb25zdCB1cGRhdGVDb25maWdzID0gKHQ6IGFueSwgY29uZmlnczogU2xhQ29uZmlndXJhdGlvbltdLCBzbGFNYXA6IFNsYURhdGFNYXApOiB2b2lkID0+IHtcbiAgICBnZXRDYXJkQWN0aW9ucyh0KS50aGVuKChhY3Rpb25zKSA9PiB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRTbGFEYXRhID0gZ2V0VXBkYXRlZFNsYURhdGEoYWN0aW9ucywgY29uZmlncywgc2xhTWFwKTtcbiAgICAgICAgaWYgKHVwZGF0ZWRTbGFEYXRhKSB7XG4gICAgICAgICAgICBjb25zdCBzbGFEYXRhV2l0aFJlbW92YWxzID0gZ2V0U2xhRGF0YVdpdGhSZW1vdmFscyhjb25maWdzLCB1cGRhdGVkU2xhRGF0YSk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzbGFEYXRhV2l0aFJlbW92YWxzID8gc2xhRGF0YVdpdGhSZW1vdmFscyA6IHVwZGF0ZWRTbGFEYXRhO1xuICAgICAgICAgICAgc2V0U2xhRGF0YSh0LCByZXN1bHQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3Qgc2xhRGF0YVdpdGhSZW1vdmFscyA9IGdldFNsYURhdGFXaXRoUmVtb3ZhbHMoY29uZmlncywgc2xhTWFwKTtcbiAgICAgICAgICAgIGlmIChzbGFEYXRhV2l0aFJlbW92YWxzKSB7XG4gICAgICAgICAgICAgICAgc2V0U2xhRGF0YSh0LCBzbGFEYXRhV2l0aFJlbW92YWxzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxuLy8gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vamVkLzk4Mjg4M1xuZXhwb3J0IGNvbnN0IGdlbmVyYXRlVXVpZCA9IGZ1bmN0aW9uICgpOiBzdHJpbmcgeyByZXR1cm4gKFwiXCIgKyAxZTcgKyAtMWUzICsgLTRlMyArIC04ZTMgKyAtMWUxMSkucmVwbGFjZSgvMXwwL2csIGZ1bmN0aW9uICgpIHsgcmV0dXJuICgwIHwgTWF0aC5yYW5kb20oKSAqIDE2KS50b1N0cmluZygxNik7IH0pOyB9O1xuIl0sIm1hcHBpbmdzIjoiQUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWlCQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/util.ts\n");

/***/ })

/******/ });